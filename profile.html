<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - Diane Keaton Memorial Arcade</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --neon-blue: #00f3ff;
            --neon-purple: #bf00ff;
            --neon-pink: #ff00ff;
            --neon-green: #39ff14;
            --dark-bg: #050510;
            --darker: #020208;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background: var(--dark-bg);
            color: white;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(90deg, transparent 49%, rgba(0, 243, 255, 0.1) 50%, transparent 51%),
                linear-gradient(0deg, transparent 49%, rgba(0, 243, 255, 0.1) 50%, transparent 51%);
            background-size: 50px 50px;
            z-index: -1;
            animation: gridMove 20s linear infinite;
        }
        
        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }
        
        .nav-bar {
            position: sticky;
            top: 0;
            background: rgba(5, 5, 16, 0.98);
            backdrop-filter: blur(30px);
            padding: 20px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid var(--neon-blue);
            box-shadow: 0 5px 40px rgba(0, 243, 255, 0.4);
            z-index: 2000;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .nav-brand {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5em;
            font-weight: 900;
            color: var(--neon-blue);
            text-shadow: 0 0 20px var(--neon-blue);
            letter-spacing: 2px;
        }
        
        .nav-links {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
        }
        
        .nav-link {
            font-family: 'Orbitron', sans-serif;
            color: white;
            text-decoration: none;
            padding: 12px 28px;
            border: 2px solid var(--neon-blue);
            border-radius: 30px;
            transition: all 0.3s;
            font-weight: 700;
            letter-spacing: 1px;
            font-size: 0.9em;
        }
        
        .nav-link:hover {
            background: var(--neon-blue);
            color: var(--darker);
            box-shadow: 0 0 30px var(--neon-blue);
            transform: translateY(-3px);
        }
        
        .logout-btn {
            background: linear-gradient(135deg, var(--neon-purple), var(--neon-pink));
            border: none;
            box-shadow: 0 0 25px var(--neon-purple);
            cursor: pointer;
        }
        
        .container {
            max-width: 1600px;
            margin: 60px auto;
            padding: 0 40px;
        }
        
        .profile-banner {
            position: relative;
            height: 300px;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            border-radius: 30px 30px 0 0;
            overflow: hidden;
            border: 3px solid var(--neon-blue);
            border-bottom: none;
        }
        
        .banner-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .banner-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent, rgba(5, 5, 16, 0.8));
        }
        
        .edit-banner-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 12px 30px;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            border: 2px solid var(--neon-blue);
            border-radius: 25px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 10;
        }
        
        .edit-banner-btn:hover {
            background: var(--neon-blue);
            color: var(--darker);
            box-shadow: 0 0 30px var(--neon-blue);
        }
        
        .profile-header {
            background: rgba(5, 5, 16, 0.95);
            border: 3px solid var(--neon-blue);
            border-top: none;
            border-radius: 0 0 30px 30px;
            padding: 50px;
            margin-bottom: 40px;
            box-shadow: 0 0 60px rgba(0, 243, 255, 0.4);
            display: flex;
            align-items: flex-start;
            gap: 50px;
            flex-wrap: wrap;
            position: relative;
            margin-top: -100px;
        }
        
        .avatar-container {
            position: relative;
            margin-top: -80px;
        }
        
        .profile-avatar {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 5px solid var(--neon-blue);
            box-shadow: 0 0 60px var(--neon-blue);
            object-fit: cover;
            animation: avatarGlow 3s ease infinite;
            background: var(--darker);
        }
        
        @keyframes avatarGlow {
            0%, 100% { box-shadow: 0 0 60px var(--neon-blue); }
            50% { box-shadow: 0 0 100px var(--neon-blue), 0 0 140px var(--neon-purple); }
        }
        
        .edit-avatar-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--neon-blue);
            border: 3px solid var(--darker);
            color: var(--darker);
            font-size: 1.5em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .edit-avatar-btn:hover {
            background: var(--neon-purple);
            transform: scale(1.1);
            box-shadow: 0 0 30px var(--neon-purple);
        }
        
        .profile-info {
            flex: 1;
            padding-top: 20px;
        }
        
        .profile-username {
            font-family: 'Orbitron', sans-serif;
            font-size: 3em;
            font-weight: 900;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }
        
        .profile-email {
            font-size: 1.1em;
            color: var(--neon-blue);
            margin-bottom: 20px;
            opacity: 0.8;
        }
        
        .profile-level {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5em;
            color: var(--neon-green);
            margin-bottom: 20px;
            text-shadow: 0 0 20px var(--neon-green);
        }
        
        .xp-bar-container {
            width: 100%;
            max-width: 500px;
            height: 40px;
            background: rgba(0, 243, 255, 0.1);
            border: 2px solid var(--neon-blue);
            border-radius: 20px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .xp-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            border-radius: 20px;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            box-shadow: 0 0 30px var(--neon-blue);
        }
        
        .social-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .social-btn {
            padding: 12px 30px;
            background: rgba(0, 243, 255, 0.1);
            border: 2px solid var(--neon-blue);
            border-radius: 25px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .social-btn:hover {
            background: var(--neon-blue);
            color: var(--darker);
            box-shadow: 0 0 30px var(--neon-blue);
            transform: translateY(-3px);
        }
        
        .social-btn.friended {
            background: var(--neon-green);
            border-color: var(--neon-green);
            color: var(--darker);
        }
        
        .profile-stats {
            display: flex;
            gap: 30px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            text-align: center;
            background: rgba(0, 243, 255, 0.05);
            padding: 15px 25px;
            border-radius: 15px;
            border: 2px solid rgba(0, 243, 255, 0.3);
        }
        
        .stat-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 2em;
            font-weight: 900;
            color: var(--neon-blue);
            text-shadow: 0 0 20px var(--neon-blue);
            display: block;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5em;
            font-weight: 900;
            text-align: center;
            margin: 60px 0 40px;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
        }
        
        .section-title::after {
            content: '';
            display: block;
            width: 150px;
            height: 4px;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            margin: 20px auto;
            border-radius: 10px;
            box-shadow: 0 0 20px var(--neon-blue);
        }
        
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 60px;
        }
        
        .achievement-card {
            background: rgba(5, 5, 16, 0.85);
            border: 2px solid var(--neon-purple);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s;
            position: relative;
        }
        
        .achievement-card.locked {
            opacity: 0.3;
            filter: grayscale(100%);
        }
        
        .achievement-card:not(.locked):hover {
            transform: scale(1.05);
            box-shadow: 0 0 50px var(--neon-purple);
            border-color: var(--neon-pink);
        }
        
        .achievement-icon {
            font-size: 4em;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 20px var(--neon-purple));
        }
        
        .achievement-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3em;
            font-weight: 900;
            color: var(--neon-purple);
            margin-bottom: 10px;
        }
        
        .achievement-desc {
            font-size: 0.9em;
            opacity: 0.8;
            line-height: 1.5;
        }
        
        .achievement-date {
            font-size: 0.8em;
            color: var(--neon-blue);
            margin-top: 10px;
            font-family: 'Orbitron', sans-serif;
        }
        
        .achievement-xp {
            margin-top: 10px;
            color: var(--neon-green);
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
        }
        
        .lock-icon {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5em;
        }
        
        .like-btn {
            position: absolute;
            bottom: 15px;
            right: 15px;
            background: rgba(255, 0, 100, 0.2);
            border: 2px solid var(--neon-pink);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.2em;
        }
        
        .like-btn:hover {
            background: var(--neon-pink);
            transform: scale(1.15);
            box-shadow: 0 0 30px var(--neon-pink);
        }
        
        .like-btn.liked {
            background: var(--neon-pink);
            box-shadow: 0 0 20px var(--neon-pink);
        }
        
        .like-count {
            position: absolute;
            top: -10px;
            right: -10px;
            background: var(--neon-pink);
            color: var(--darker);
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
        }
        
        .scores-table {
            background: rgba(5, 5, 16, 0.85);
            border: 3px solid var(--neon-blue);
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 60px;
            box-shadow: 0 0 40px rgba(0, 243, 255, 0.3);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        thead {
            background: rgba(0, 243, 255, 0.2);
        }
        
        th {
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            padding: 20px;
            text-align: left;
            color: var(--neon-blue);
            font-size: 1.1em;
            letter-spacing: 1px;
            border-bottom: 2px solid var(--neon-blue);
        }
        
        td {
            padding: 20px;
            border-bottom: 1px solid rgba(0, 243, 255, 0.1);
        }
        
        tbody tr {
            transition: all 0.3s;
        }
        
        tbody tr:hover {
            background: rgba(0, 243, 255, 0.05);
            transform: translateX(5px);
        }
        
        .game-icon-small {
            font-size: 1.5em;
            margin-right: 10px;
        }
        
        .score-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3em;
            font-weight: 700;
            color: var(--neon-green);
            text-shadow: 0 0 20px var(--neon-green);
        }
        
        .score-like-btn {
            background: rgba(255, 0, 100, 0.2);
            border: 2px solid var(--neon-pink);
            border-radius: 20px;
            padding: 8px 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
        }
        
        .score-like-btn:hover {
            background: var(--neon-pink);
            transform: scale(1.05);
            box-shadow: 0 0 20px var(--neon-pink);
        }
        
        .score-like-btn.liked {
            background: var(--neon-pink);
        }
        
        .rank-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 15px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            font-size: 0.9em;
        }
        
        .rank-1 {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #000;
        }
        
        .rank-2 {
            background: linear-gradient(135deg, #c0c0c0, #e8e8e8);
            color: #000;
        }
        
        .rank-3 {
            background: linear-gradient(135deg, #cd7f32, #e8a87c);
            color: #000;
        }
        
        .no-scores {
            text-align: center;
            padding: 60px;
            font-size: 1.2em;
            opacity: 0.6;
        }
        
        .no-scores-icon {
            font-size: 3em;
            margin-bottom: 20px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: rgba(5, 5, 16, 0.98);
            border: 3px solid var(--neon-blue);
            border-radius: 30px;
            padding: 50px;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 0 80px rgba(0, 243, 255, 0.6);
            position: relative;
        }
        
        .modal-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2em;
            font-weight: 900;
            color: var(--neon-blue);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--neon-pink);
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .close-modal:hover {
            transform: rotate(90deg) scale(1.1);
            box-shadow: 0 0 30px var(--neon-pink);
        }
        
        .avatar-options, .banner-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .option-item {
            aspect-ratio: 1;
            border: 3px solid var(--neon-blue);
            border-radius: 15px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .option-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .option-item:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px var(--neon-blue);
        }
        
        .option-item.selected {
            border-color: var(--neon-green);
            box-shadow: 0 0 30px var(--neon-green);
        }
        
        .option-item.selected::after {
            content: '‚úì';
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--neon-green);
            color: var(--darker);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.2em;
        }
        
        .save-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            border: none;
            border-radius: 50px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            font-size: 1.1em;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 30px rgba(0, 243, 255, 0.4);
        }
        
        .save-btn:hover {
            box-shadow: 0 10px 50px rgba(0, 243, 255, 0.8);
            transform: translateY(-3px);
        }
        
        .footer {
            text-align: center;
            padding: 40px;
            margin-top: 80px;
            border-top: 2px solid rgba(0, 243, 255, 0.2);
            opacity: 0.7;
        }
        
        @media (max-width: 768px) {
            .profile-header {
                flex-direction: column;
                text-align: center;
                padding: 30px;
            }
            .avatar-container {
                margin-top: -120px;
            }
            .profile-username { font-size: 2em; }
            .achievements-grid { grid-template-columns: 1fr; }
            table { font-size: 0.85em; }
            th, td { padding: 12px 8px; }
            .nav-bar { padding: 15px 20px; }
            .nav-brand { font-size: 1.2em; }
            .modal-content { padding: 30px; }
            .avatar-options, .banner-options {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <div class="nav-brand">üéÆ MY PROFILE</div>
        <div class="nav-links">
            <a href="index.html" class="nav-link">HOME</a>
            <a href="leaderboard.html" class="nav-link">LEADERBOARDS</a>
            <button class="nav-link logout-btn" onclick="logout()">LOGOUT</button>
        </div>
    </nav>
    
    <div class="container">
        <div class="profile-banner">
            <img src="" alt="Profile Banner" class="banner-image" id="profile-banner">
            <div class="banner-overlay"></div>
            <button class="edit-banner-btn" onclick="openBannerModal()">‚úèÔ∏è CHANGE BANNER</button>
        </div>
        
        <div class="profile-header">
            <div class="avatar-container">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=user" alt="Avatar" class="profile-avatar" id="user-avatar">
                <button class="edit-avatar-btn" onclick="openAvatarModal()">‚úèÔ∏è</button>
            </div>
            <div class="profile-info">
                <h1 class="profile-username" id="username">Loading...</h1>
                <div class="profile-email" id="email">email@example.com</div>
                <div class="profile-level">
                    <span>‚ö° LEVEL <span id="user-level">1</span></span>
                </div>
                <div class="xp-bar-container">
                    <div class="xp-bar" id="xp-bar" style="width: 0%">
                        <span id="xp-text">0 / 100 XP</span>
                    </div>
                </div>
                
                <div class="social-actions">
                    <button class="social-btn" id="friend-btn" onclick="toggleFriend()">
                        <span>üë•</span>
                        <span id="friend-text">ADD FRIEND</span>
                    </button>
                    <button class="social-btn">
                        <span>üìä</span>
                        <span>COMPARE STATS</span>
                    </button>
                </div>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <span class="stat-value" id="stat-achievements">0</span>
                        <div class="stat-label">üèÜ Achievements</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-games">0</span>
                        <div class="stat-label">üéÆ Games Played</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-coins">100</span>
                        <div class="stat-label">üí∞ Coins</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-friends">0</span>
                        <div class="stat-label">üë• Friends</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-joined">...</span>
                        <div class="stat-label">üìÖ Member Since</div>
                    </div>
                </div>
            </div>
        </div>
        
        <h2 class="section-title">üèÜ MY ACHIEVEMENTS</h2>
        <div class="achievements-grid" id="achievements-container"></div>
        
        <h2 class="section-title">üéÆ MY HIGH SCORES</h2>
        <div class="scores-table">
            <table>
                <thead>
                    <tr>
                        <th>GAME</th>
                        <th>HIGH SCORE</th>
                        <th>RANK</th>
                        <th>LIKES</th>
                        <th>DATE</th>
                    </tr>
                </thead>
                <tbody id="scores-tbody"></tbody>
            </table>
        </div>
        
        <div class="footer">
            <p>üíú Diane Keaton Memorial Arcade ¬© 2025</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Keep playing, keep achieving! ‚òï</p>
        </div>
    </div>
    
    <div class="modal" id="avatar-modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('avatar-modal')">√ó</button>
            <h2 class="modal-title">CHOOSE YOUR AVATAR</h2>
            <div class="avatar-options" id="avatar-options"></div>
            <button class="save-btn" onclick="saveAvatar()">SAVE AVATAR</button>
        </div>
    </div>
    
    <div class="modal" id="banner-modal">
        <div class="modal-content">
            <button class="close-
              modal" onclick="closeModal('banner-modal')">√ó</button>
<h2 class="modal-title">CHOOSE YOUR BANNER</h2>
<div class="banner-options" id="banner-options"></div>
<button class="save-btn" onclick="saveBanner()">SAVE BANNER</button>
</div>
</div>
<script>
    const allAchievements = [
        { id: 'annie_hall', name: 'Annie Hall', description: 'Play your first game', icon: 'üé¨', xp: 10 },
        { id: 'godfather', name: 'The Godfather', description: 'Reach Level 10', icon: 'üëë', xp: 50 },
        { id: 'something_gotta_give', name: "Something's Gotta Give", description: 'Score 10,000 points total', icon: 'üíé', xp: 100 },
        { id: 'manhattan', name: 'Manhattan', description: 'Win 50 games', icon: 'üèôÔ∏è', xp: 200 },
        { id: 'reds', name: 'Reds', description: 'Earn 20 achievements', icon: '‚≠ê', xp: 150 },
        { id: 'first_wives_club', name: 'First Wives Club', description: 'Complete all games', icon: 'üí™', xp: 500 },
        { id: 'father_bride', name: 'Father of the Bride', description: 'Play 100 games', icon: 'üë∞', xp: 300 },
        { id: 'marvins_room', name: "Marvin's Room", description: 'Reach Level 25', icon: 'üè†', xp: 250 },
        { id: 'baby_boom', name: 'Baby Boom', description: 'Win 5 games in one day', icon: 'üë∂', xp: 75 },
        { id: 'manhattan_murder', name: 'Manhattan Murder Mystery', description: 'Find 10 easter eggs', icon: 'üîç', xp: 125 },
        { id: 'sleeper', name: 'Sleeper', description: 'Play for 24 hours total', icon: 'üò¥', xp: 200 },
        { id: 'love_death', name: 'Love and Death', description: 'Lose 100 times but keep playing', icon: 'üíÄ', xp: 50 },
        { id: 'play_again_sam', name: 'Play It Again, Sam', description: 'Replay a game 10 times', icon: 'üé≠', xp: 100 },
        { id: 'shoot_moon', name: 'Shoot the Moon', description: 'Get a perfect score', icon: 'üåô', xp: 300 },
        { id: 'good_mother', name: 'The Good Mother', description: 'Help 50 friends', icon: '‚ú®', xp: 150 },
        { id: 'morning_glory', name: 'Morning Glory', description: 'Play before 8 AM', icon: 'üåÖ', xp: 50 }
    ];
    
    const games = [
        { id: 'motherload', name: 'MotherLoad', icon: '‚õèÔ∏è' },
        { id: 'happywheels', name: 'Happy Wheels', icon: 'üé°' },
        { id: 'gunblood', name: 'Gun Blood', icon: 'üî´' },
        { id: 'raftwars', name: 'Raft Wars', icon: 'üö£' },
        { id: 'raftwars2', name: 'Raft Wars 2', icon: 'üö£' },
        { id: 'robotunicornattack', name: 'Robot Unicorn Attack', icon: 'ü¶Ñ' },
        { id: 'earntodie', name: 'Earn to Die', icon: 'üßü' },
        { id: 'bushshootout', name: 'Bush Shootout', icon: 'üéØ' },
        { id: 'candymachine', name: 'Candy Machine', icon: 'üç¨' },
        { id: 'gold01', name: 'Gold Miner', icon: '‚öîÔ∏è' },
        { id: 'tomandjerrybowling', name: 'Tom & Jerry Bowling', icon: 'üé≥' },
        { id: 'ruahm', name: 'Robot Unicorn Attack: Heavy Metal', icon: 'ü¶Ñ' }
    ];
    
    const avatarOptions = [
        'https://api.dicebear.com/7.x/avataaars/svg?seed=felix',
        'https://api.dicebear.com/7.x/avataaars/svg?seed=aneka',
        'https://api.dicebear.com/7.x/avataaars/svg?seed=luna',
        'https://api.dicebear.com/7.x/avataaars/svg?seed=max',
        'https://api.dicebear.com/7.x/avataaars/svg?seed=charlie',
        'https://api.dicebear.com/7.x/avataaars/svg?seed=oliver',
        'https://api.dicebear.com/7.x/avataaars/svg?seed=bella',
        'https://api.dicebear.com/7.x/avataaars/svg?seed=milo',
        'https://api.dicebear.com/7.x/bottts/svg?seed=robot1',
        'https://api.dicebear.com/7.x/bottts/svg?seed=robot2',
        'https://api.dicebear.com/7.x/personas/svg?seed=person1',
        'https://api.dicebear.com/7.x/personas/svg?seed=person2'
    ];
    
    const bannerOptions = [
        'https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=1200&h=400&fit=crop',
        'https://images.unsplash.com/photo-1511512578047-dfb367046420?w=1200&h=400&fit=crop',
        'https://images.unsplash.com/photo-1538481199705-c710c4e965fc?w=1200&h=400&fit=crop',
        'https://images.unsplash.com/photo-1542751371-adc38448a05e?w=1200&h=400&fit=crop',
        'https://images.unsplash.com/photo-1557682250-33bd709cbe85?w=1200&h=400&fit=crop',
        'https://images.unsplash.com/photo-1579546929518-9e396f3cc809?w=1200&h=400&fit=crop',
        'https://images.unsplash.com/photo-1557682224-5b8590cd9ec5?w=1200&h=400&fit=crop',
        'https://images.unsplash.com/photo-1557682268-e3955ed5d83f?w=1200&h=400&fit=crop'
    ];
    
    let selectedAvatar = null;
    let selectedBanner = null;
    
    if (localStorage.getItem('isLoggedIn') !== 'true') {
        window.location.href = 'login.html';
    }
    
    let userData = JSON.parse(localStorage.getItem('arcadeUser'));
    
    if (userData) {
        if (!userData.avatar) userData.avatar = `https://api.dicebear.com/7.x/avataaars/svg?seed=${userData.username}`;
        if (!userData.banner) userData.banner = bannerOptions[0];
        if (!userData.friends) userData.friends = [];
        if (!userData.likedAchievements) userData.likedAchievements = {};
        if (!userData.likedScores) userData.likedScores = {};
        
        document.getElementById('username').textContent = userData.username.toUpperCase();
        document.getElementById('email').textContent = userData.email;
        document.getElementById('user-level').textContent = userData.level || 1;
        document.getElementById('stat-achievements').textContent = (userData.achievements || []).filter(a => a.unlocked).length;
        document.getElementById('stat-games').textContent = userData.gamesPlayed || 0;
        document.getElementById('stat-coins').textContent = userData.coins || 100;
        document.getElementById('stat-friends').textContent = userData.friends.length || 0;
        
        const joinDate = new Date(userData.joinDate);
        const monthYear = joinDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
        document.getElementById('stat-joined').textContent = monthYear;
        
        document.getElementById('user-avatar').src = userData.avatar;
        document.getElementById('profile-banner').src = userData.banner;
        
        const currentXP = userData.xp || 0;
        const xpForNextLevel = userData.level * 100;
        const xpProgress = Math.min((currentXP / xpForNextLevel) * 100, 100);
        document.getElementById('xp-bar').style.width = xpProgress + '%';
        document.getElementById('xp-text').textContent = `${currentXP} / ${xpForNextLevel} XP`;
        
        loadAchievements(userData);
        loadHighScores(userData);
        localStorage.setItem('arcadeUser', JSON.stringify(userData));
    }
    
    function loadAchievements(userData) {
        const container = document.getElementById('achievements-container');
        container.innerHTML = '';
        const userAchievements = userData.achievements || [];
        
        allAchievements.forEach(achievement => {
            const userAch = userAchievements.find(a => a.id === achievement.id);
            const isUnlocked = userAch && userAch.unlocked;
            const card = document.createElement('div');
            card.className = 'achievement-card' + (isUnlocked ? '' : ' locked');
            
            let dateText = '';
            if (isUnlocked && userAch.unlockedAt) {
                const date = new Date(userAch.unlockedAt);
                dateText = `<div class="achievement-date">Unlocked ${date.toLocaleDateString()}</div>`;
            }
            
            const likes = userData.likedAchievements[achievement.id] || 0;
            const isLiked = false;
            
            card.innerHTML = `
                ${!isUnlocked ? '<div class="lock-icon">üîí</div>' : ''}
                <div class="achievement-icon">${achievement.icon}</div>
                <div class="achievement-name">${achievement.name}</div>
                <div class="achievement-desc">${achievement.description}</div>
                ${dateText}
                <div class="achievement-xp">+${achievement.xp} XP</div>
                ${isUnlocked ? `
                    <button class="like-btn ${isLiked ? 'liked' : ''}" onclick="likeAchievement('${achievement.id}', this)">
                        ${isLiked ? '‚ù§Ô∏è' : 'ü§ç'}
                        ${likes > 0 ? `<span class="like-count">${likes}</span>` : ''}
                    </button>
                ` : ''}
            `;
            container.appendChild(card);
        });
    }
    
    function loadHighScores(userData) {
        const tbody = document.getElementById('scores-tbody');
        tbody.innerHTML = '';
        const highScores = userData.highScores || {};
        
        if (Object.keys(highScores).length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="5" class="no-scores">
                        <div class="no-scores-icon">üéÆ</div>
                        <div>No high scores yet!</div>
                        <div style="font-size: 0.9em; margin-top: 10px;">Play some games to see your scores here!</div>
                    </td>
                </tr>
            `;
            return;
        }
        
        const scoresArray = Object.entries(highScores).map(([gameId, data]) => {
            const game = games.find(g => g.id === gameId);
            return {
                gameId,
                gameName: game ? game.name : gameId,
                gameIcon: game ? game.icon : 'üéÆ',
                score: data.score,
                rank: data.rank || Math.floor(Math.random() * 100) + 1,
                date: data.date || new Date().toISOString(),
                likes: data.likes || 0
            };
        }).sort((a, b) => b.score - a.score);
        
        scoresArray.forEach(score => {
            const row = document.createElement('tr');
            const date = new Date(score.date).toLocaleDateString();
            
            let rankHTML = `<span class="rank-badge">#${score.rank}</span>`;
            if (score.rank === 1) rankHTML = '<span class="rank-badge rank-1">ü•á #1</span>';
            else if (score.rank === 2) rankHTML = '<span class="rank-badge rank-2">ü•à #2</span>';
            else if (score.rank === 3) rankHTML = '<span class="rank-badge rank-3">ü•â #3</span>';
            
            const isLiked = false;
            
            row.innerHTML = `
                <td>
                    <span class="game-icon-small">${score.gameIcon}</span>
                    <strong>${score.gameName}</strong>
                </td>
                <td><span class="score-value">${score.score.toLocaleString()}</span></td>
                <td>${rankHTML}</td>
                <td>
                    <button class="score-like-btn ${isLiked ? 'liked' : ''}" onclick="likeScore('${score.gameId}', this)">
                        ${isLiked ? '‚ù§Ô∏è' : 'ü§ç'} ${score.likes}
                    </button>
                </td>
                <td>${date}</td>
            `;
            tbody.appendChild(row);
        });
    }
    
    function openAvatarModal() {
        const modal = document.getElementById('avatar-modal');
        const container = document.getElementById('avatar-options');
        container.innerHTML = '';
        
        avatarOptions.forEach((avatarUrl, index) => {
            const option = document.createElement('div');
            option.className = 'option-item';
            if (userData.avatar === avatarUrl) option.classList.add('selected');
            option.innerHTML = `<img src="${avatarUrl}" alt="Avatar ${index + 1}">`;
            option.onclick = () => selectAvatar(avatarUrl, option);
            container.appendChild(option);
        });
        modal.classList.add('active');
    }
    
    function selectAvatar(url, element) {
        selectedAvatar = url;
        document.querySelectorAll('#avatar-options .option-item').forEach(el => el.classList.remove('selected'));
        element.classList.add('selected');
    }
    
    function saveAvatar() {
        if (selectedAvatar) {
            userData.avatar = selectedAvatar;
            document.getElementById('user-avatar').src = selectedAvatar;
            localStorage.setItem('arcadeUser', JSON.stringify(userData));
            closeModal('avatar-modal');
            alert('‚úÖ Avatar updated successfully!');
        }
    }
    
    function openBannerModal() {
        const modal = document.getElementById('banner-modal');
        const container = document.getElementById('banner-options');
        container.innerHTML = '';
        
        bannerOptions.forEach((bannerUrl, index) => {
            const option = document.createElement('div');
            option.className = 'option-item';
            if (userData.banner === bannerUrl) option.classList.add('selected');
            option.innerHTML = `<img src="${bannerUrl}" alt="Banner ${index + 1}">`;
            option.onclick = () => selectBanner(bannerUrl, option);
            container.appendChild(option);
        });
        modal.classList.add('active');
    }
    
    function selectBanner(url, element) {
        selectedBanner = url;
        document.querySelectorAll('#banner-options .option-item').forEach(el => el.classList.remove('selected'));
        element.classList.add('selected');
    }
    
    function saveBanner() {
        if (selectedBanner) {
            userData.banner = selectedBanner;
            document.getElementById('profile-banner').src = selectedBanner;
            localStorage.setItem('arcadeUser', JSON.stringify(userData));
            closeModal('banner-modal');
            alert('‚úÖ Banner updated successfully!');
        }
    }
    
    function closeModal(modalId) {
        document.getElementById(modalId).classList.remove('active');
        selectedAvatar = null;
        selectedBanner = null;
    }
    
    function toggleFriend() {
        const btn = document.getElementById('friend-btn');
        const text = document.getElementById('friend-text');
        
        if (btn.classList.contains('friended')) {
            btn.classList.remove('friended');
            text.textContent = 'ADD FRIEND';
            userData.friends = userData.friends.filter(f => f !== 'viewingUser');
        } else {
            btn.classList.add('friended');
            text.textContent = '‚úì FRIENDS';
            userData.friends.push('viewingUser');
        }
        
        document.getElementById('stat-friends').textContent = userData.friends.length;
        localStorage.setItem('arcadeUser', JSON.stringify(userData));
    }
    
    function likeAchievement(achievementId, button) {
        if (!userData.likedAchievements[achievementId]) {
            userData.likedAchievements[achievementId] = 0;
        }
        
        const isLiked = button.classList.contains('liked');
        
        if (isLiked) {
            button.classList.remove('liked');
            button.innerHTML = 'ü§ç';
            userData.likedAchievements[achievementId]--;
        } else {
            button.classList.add('liked');
            userData.likedAchievements[achievementId]++;
            button.innerHTML = `‚ù§Ô∏è <span class="like-count">${userData.likedAchievements[achievementId]}</span>`;
        }
        localStorage.setItem('arcadeUser', JSON.stringify(userData));
    }
    
    function likeScore(gameId, button) {
        const isLiked = button.classList.contains('liked');
        const currentLikes = parseInt(button.textContent.match(/\d+/)?.[0] || 0);
        
        if (isLiked) {
            button.classList.remove('liked');
            button.innerHTML = `ü§ç ${currentLikes - 1}`;
        } else {
            button.classList.add('liked');
            button.innerHTML = `‚ù§Ô∏è ${currentLikes + 1}`;
        }
    }
    
    function logout() {
        if (confirm('Are you sure you want to logout?')) {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('arcadeUser');
            window.location.href = 'login.html';
        }
    }
    
    window.onclick = function(event) {
        if (event.target.classList.contains('modal')) {
            event.target.classList.remove('active');
        }
    }
</script>
