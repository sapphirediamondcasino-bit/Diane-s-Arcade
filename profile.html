<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - Diane Keaton Memorial Arcade</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --neon-blue: #00f3ff;
            --neon-purple: #bf00ff;
            --neon-pink: #ff00ff;
            --neon-green: #39ff14;
            --dark-bg: #050510;
            --darker: #020208;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background: var(--dark-bg);
            color: white;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: 
                linear-gradient(90deg, transparent 49%, rgba(0, 243, 255, 0.1) 50%, transparent 51%),
                linear-gradient(0deg, transparent 49%, rgba(0, 243, 255, 0.1) 50%, transparent 51%);
            background-size: 50px 50px;
            z-index: -1;
            animation: gridMove 20s linear infinite;
        }
        
        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }
        
        .nav-bar {
            position: sticky;
            top: 0;
            background: rgba(5, 5, 16, 0.98);
            backdrop-filter: blur(30px);
            padding: 20px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid var(--neon-blue);
            box-shadow: 0 5px 40px rgba(0, 243, 255, 0.4);
            z-index: 2000;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .nav-brand {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5em;
            font-weight: 900;
            color: var(--neon-blue);
            text-shadow: 0 0 20px var(--neon-blue);
            letter-spacing: 2px;
        }
        
        .nav-links {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
        }
        
        .nav-link {
            font-family: 'Orbitron', sans-serif;
            color: white;
            text-decoration: none;
            padding: 12px 28px;
            border: 2px solid var(--neon-blue);
            border-radius: 30px;
            transition: all 0.3s;
            font-weight: 700;
            letter-spacing: 1px;
            font-size: 0.9em;
        }
        
        .nav-link:hover {
            background: var(--neon-blue);
            color: var(--darker);
            box-shadow: 0 0 30px var(--neon-blue);
            transform: translateY(-3px);
        }
        
        .logout-btn {
            background: linear-gradient(135deg, var(--neon-purple), var(--neon-pink));
            border: none;
            box-shadow: 0 0 25px var(--neon-purple);
            cursor: pointer;
        }
        
        .container {
            max-width: 1600px;
            margin: 60px auto;
            padding: 0 40px;
        }
        
        .profile-banner {
            position: relative;
            height: 300px;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            border-radius: 30px 30px 0 0;
            overflow: hidden;
            border: 3px solid var(--neon-blue);
            border-bottom: none;
        }
        
        .banner-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .banner-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent, rgba(5, 5, 16, 0.8));
        }
        
        .edit-banner-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 12px 30px;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            border: 2px solid var(--neon-blue);
            border-radius: 25px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 10;
        }
        
        .edit-banner-btn:hover {
            background: var(--neon-blue);
            color: var(--darker);
            box-shadow: 0 0 30px var(--neon-blue);
        }
        
        .profile-header {
            background: rgba(5, 5, 16, 0.95);
            border: 3px solid var(--neon-blue);
            border-top: none;
            border-radius: 0 0 30px 30px;
            padding: 50px;
            margin-bottom: 40px;
            box-shadow: 0 0 60px rgba(0, 243, 255, 0.4);
            display: flex;
            align-items: flex-start;
            gap: 50px;
            flex-wrap: wrap;
            position: relative;
            margin-top: -100px;
        }
        
        .avatar-container {
            position: relative;
            margin-top: -80px;
        }
        
        .profile-avatar {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 5px solid var(--neon-blue);
            box-shadow: 0 0 60px var(--neon-blue);
            object-fit: cover;
            animation: avatarGlow 3s ease infinite;
            background: var(--darker);
        }
        
        @keyframes avatarGlow {
            0%, 100% { box-shadow: 0 0 60px var(--neon-blue); }
            50% { box-shadow: 0 0 100px var(--neon-blue), 0 0 140px var(--neon-purple); }
        }
        
        .edit-avatar-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--neon-blue);
            border: 3px solid var(--darker);
            color: var(--darker);
            font-size: 1.5em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .edit-avatar-btn:hover {
            background: var(--neon-purple);
            transform: scale(1.1);
            box-shadow: 0 0 30px var(--neon-purple);
        }
        
        .profile-info {
            flex: 1;
            padding-top: 20px;
        }
        
        .profile-username {
            font-family: 'Orbitron', sans-serif;
            font-size: 3em;
            font-weight: 900;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }
        
        .profile-bio {
            font-size: 1.1em;
            color: var(--neon-blue);
            margin-bottom: 20px;
            opacity: 0.8;
            position: relative;
            padding: 15px;
            background: rgba(0, 243, 255, 0.05);
            border-radius: 15px;
            border: 2px solid rgba(0, 243, 255, 0.2);
        }
        
        .edit-bio-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 243, 255, 0.2);
            border: 2px solid var(--neon-blue);
            color: var(--neon-blue);
            border-radius: 20px;
            padding: 5px 15px;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.8em;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .edit-bio-btn:hover {
            background: var(--neon-blue);
            color: var(--darker);
        }
        
        .profile-level {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5em;
            color: var(--neon-green);
            margin-bottom: 20px;
            text-shadow: 0 0 20px var(--neon-green);
        }
        
        .xp-bar-container {
            width: 100%;
            max-width: 500px;
            height: 40px;
            background: rgba(0, 243, 255, 0.1);
            border: 2px solid var(--neon-blue);
            border-radius: 20px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .xp-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            border-radius: 20px;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            box-shadow: 0 0 30px var(--neon-blue);
        }
        
        .social-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .social-btn {
            padding: 12px 30px;
            background: rgba(0, 243, 255, 0.1);
            border: 2px solid var(--neon-blue);
            border-radius: 25px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .social-btn:hover {
            background: var(--neon-blue);
            color: var(--darker);
            box-shadow: 0 0 30px var(--neon-blue);
            transform: translateY(-3px);
        }
        
        .social-btn.friended {
            background: var(--neon-green);
            border-color: var(--neon-green);
            color: var(--darker);
        }
        
        .profile-stats {
            display: flex;
            gap: 30px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            text-align: center;
            background: rgba(0, 243, 255, 0.05);
            padding: 15px 25px;
            border-radius: 15px;
            border: 2px solid rgba(0, 243, 255, 0.3);
        }
        
        .stat-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 2em;
            font-weight: 900;
            color: var(--neon-blue);
            text-shadow: 0 0 20px var(--neon-blue);
            display: block;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5em;
            font-weight: 900;
            text-align: center;
            margin: 60px 0 40px;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .section-title::after {
            content: '';
            display: block;
            width: 150px;
            height: 4px;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            margin: 20px auto;
            border-radius: 10px;
            box-shadow: 0 0 20px var(--neon-blue);
        }
        
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 60px;
        }
        
        .achievement-card {
            background: rgba(5, 5, 16, 0.85);
            border: 2px solid var(--neon-purple);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s;
            position: relative;
        }
        
        .achievement-card.locked {
            opacity: 0.3;
            filter: grayscale(100%);
        }
        
        .achievement-card:not(.locked):hover {
            transform: scale(1.05);
            box-shadow: 0 0 50px var(--neon-purple);
        }
        
        .achievement-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }
        
        .achievement-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3em;
            font-weight: 900;
            color: var(--neon-purple);
            margin-bottom: 10px;
        }
        
        .achievement-desc {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .achievement-xp {
            margin-top: 10px;
            color: var(--neon-green);
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
        }
        
        .lock-icon {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5em;
        }
        
        .scores-table {
            background: rgba(5, 5, 16, 0.85);
            border: 3px solid var(--neon-blue);
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 60px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        thead {
            background: rgba(0, 243, 255, 0.2);
        }
        
        th {
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            padding: 25px 20px;
            text-align: left;
            color: var(--neon-blue);
        }
        
        td {
            padding: 25px 20px;
            border-bottom: 1px solid rgba(0, 243, 255, 0.1);
        }
        
        tbody tr:hover {
            background: rgba(0, 243, 255, 0.05);
        }
        
        .score-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3em;
            font-weight: 700;
            color: var(--neon-green);
        }
        
        .no-scores {
            text-align: center;
            padding: 60px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.active { display: flex; }
        
        .modal-content {
            background: rgba(5, 5, 16, 0.98);
            border: 3px solid var(--neon-blue);
            border-radius: 30px;
            padding: 50px;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .modal-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2em;
            font-weight: 900;
            color: var(--neon-blue);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--neon-pink);
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .close-modal:hover {
            transform: rotate(90deg) scale(1.1);
        }
        
        .bio-input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 243, 255, 0.05);
            border: 2px solid var(--neon-blue);
            border-radius: 15px;
            color: white;
            font-size: 1em;
            font-family: 'Roboto', sans-serif;
            resize: vertical;
            min-height: 100px;
        }
        
        .avatar-options, .banner-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .option-item {
            aspect-ratio: 1;
            border: 3px solid var(--neon-blue);
            border-radius: 15px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .option-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .option-item:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px var(--neon-blue);
        }
        
        .option-item.selected {
            border-color: var(--neon-green);
            box-shadow: 0 0 30px var(--neon-green);
        }
        
        .option-item.selected::after {
            content: '✓';
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--neon-green);
            color: var(--darker);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
        }
        
        .save-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            border: none;
            border-radius: 50px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .save-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 50px rgba(0, 243, 255, 0.8);
        }
        
        @media (max-width: 768px) {
            .profile-header { flex-direction: column; text-align: center; padding: 30px; }
            .avatar-container { margin-top: -120px; }
            .profile-username { font-size: 2em; }
            .achievements-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <div class="nav-brand">🎮 MY PROFILE</div>
        <div class="nav-links">
            <a href="index.html" class="nav-link">HOME</a>
            <a href="achievements.html" class="nav-link">ACHIEVEMENTS</a>
            <a href="leaderboard.html" class="nav-link">LEADERBOARD</a>
            <a href="movies.html" class="nav-link">MOVIES 🎬</a>
            <a href="bot.html" class="nav-link">DIANE BOT 🤖</a>
            <button class="nav-link logout-btn" onclick="logout()">LOGOUT</button>
        </div>
    </nav>
    
    <div class="container">
        <div class="profile-banner">
            <img src="" alt="Banner" class="banner-image" id="profile-banner">
            <div class="banner-overlay"></div>
            <button class="edit-banner-btn" onclick="openBannerModal()">✏️ CHANGE BANNER</button>
        </div>
        
        <div class="profile-header">
            <div class="avatar-container">
                <img src="" alt="Avatar" class="profile-avatar" id="user-avatar">
                <button class="edit-avatar-btn" onclick="openAvatarModal()">✏️</button>
            </div>
            <div class="profile-info">
                <h1 class="profile-username" id="username">PLAYER</h1>
                <div class="profile-bio">
                    <button class="edit-bio-btn" onclick="openBioModal()">✏️</button>
                    <div id="bio-text">No bio yet!</div>
                </div>
                <div class="profile-level">⚡ LEVEL <span id="user-level">1</span></div>
                <div class="xp-bar-container">
                    <div class="xp-bar" id="xp-bar" style="width: 0%">
                        <span id="xp-text">0 / 1000 XP</span>
                    </div>
                </div>
                
                <div class="social-actions">
                    <button class="social-btn" id="friend-btn" onclick="toggleFriend()">
                        <span>👥</span>
                        <span id="friend-text">ADD FRIEND</span>
                    </button>
                    <button class="social-btn" onclick="alert('Compare Stats feature coming soon!')">
                        <span>📊</span>
                        <span>COMPARE STATS</span>
                    </button>
                </div>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <span class="stat-value" id="stat-achievements">0</span>
                        <div class="stat-label">🏆 Achievements</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-games">0</span>
                        <div class="stat-label">🎮 Games Played</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-coins">100</span>
                        <div class="stat-label">💰 Coins</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-friends">0</span>
                        <div class="stat-label">👥 Friends</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stat-joined">Jan 2025</span>
                        <div class="stat-label">📅 Member Since</div>
                    </div>
                </div>
            </div>
        </div>
        
        <h2 class="section-title">🏆 MY ACHIEVEMENTS</h2>
        <div class="achievements-grid" id="achievements-container"></div>
        
        <h2 class="section-title">🎮 MY HIGH SCORES</h2>
        <div class="scores-table">
            <table>
                <thead>
                    <tr>
                        <th>GAME</th>
                        <th>SCORE</th>
                        <th>RANK</th>
                        <th>DATE</th>
                    </tr>
                </thead>
                <tbody id="scores-tbody"></tbody>
            </table>
        </div>
    </div>

    <div class="modal" id="avatar-modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('avatar-modal')">×</button>
            <h2 class="modal-title">CHOOSE AVATAR</h2>
            <div class="avatar-options" id="avatar-options"></div>
            <button class="save-btn" onclick="saveAvatar()">SAVE</button>
        </div>
    </div>

    <div class="modal" id="banner-modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('banner-modal')">×</button>
            <h2 class="modal-title">CHOOSE BANNER</h2>
            <div class="banner-options" id="banner-options"></div>
            <button class="save-btn" onclick="saveBanner()">SAVE</button>
        </div>
    </div>

    <div class="modal" id="bio-modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('bio-modal')">×</button>
            <h2 class="modal-title">EDIT BIO</h2>
            <textarea class="bio-input" id="bio-input" maxlength="200"></textarea>
            <p style="text-align: right; margin: 10px 0; opacity: 0.7;">
                <span id="char-count">0</span>/200
            </p>
            <button class="save-btn" onclick="saveBio()">SAVE</button>
        </div>
    </div>

    <script>
        let userData = JSON.parse(localStorage.getItem('arcadeUser')) || {
            username: 'Guest',
            level: 1,
            xp: 0,
            coins: 100,
            achievements: [],
            gamesPlayed: 0,
            highScores: {},
            friends: [],
            joinDate: new Date().toISOString(),
            avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=guest',
            banner: 'https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=1200&h=400&fit=crop',
            bio: 'No bio yet!'
        };
        
        let selectedAvatar = null;
        let selectedBanner = null;
        
        const avatarOptions = [
            'https://api.dicebear.com/7.x/avataaars/svg?seed=felix',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=aneka',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=luna',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=max',
            'https://api.dicebear.com/7.x/avataaars/svg?seed=charlie',
            'https://api.dicebear.com/7.x/bottts/svg?seed=robot1',
            'https://api.dicebear.com/7.x/bottts/svg?seed=robot2',
            'https://api.dicebear.com/7.x/personas/svg?seed=person1'
        ];
        
        const bannerOptions = [
            'https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1511512578047-dfb367046420?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1538481199705-c710c4e965fc?w=1200&h=400&fit=crop',
            'https://images.unsplash.com/photo-1542751371-adc38448a05e?w=1200&h=400&fit=crop'
        ];
        
        const allAchievements = [
            { id: 'annie_hall', name: 'Annie Hall', description: 'Play your first game', icon: '🎬', xp: 10 },
            { id: 'first_steps', name: 'First Steps', description: 'Create profile', icon: '👣', xp: 5 },
            { id: 'coffee_break', name: 'Coffee Break', description: 'Play 5 games', icon: '☕', xp: 25 }
        ];
        
        function loadProfile() {
            document.getElementById('username').textContent = userData.username.toUpperCase();
            document.getElementById('user-level').textContent = userData.level;
            document.getElementById('user-avatar').src = userData.avatar;
            document.getElementById('profile-banner').src = userData.banner;
            document.getElementById('bio-text').textContent = userData.bio;
            
            const unlockedAchievements = userData.achievements.filter(a => a.unlocked).length;
            document.getElementById('stat-achievements').textContent = unlockedAchievements;
            document.getElementById('stat-games').textContent = userData.gamesPlayed;
            document.getElementById('stat-coins').textContent = userData.coins;
            document.getElementById('stat-friends').textContent = userData.friends ? userData.friends.length : 0;
            
            // FIXED: Join date properly formatted
            const joinDate = new Date(userData.joinDate);
            const monthYear = joinDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
            document.getElementById('stat-joined').textContent = monthYear;
            
            const xpForNext = userData.level * 1000;
            const progress = Math.min((userData.xp / xpForNext) * 100, 100);
            document.getElementById('xp-bar').style.width = progress + '%';
            document.getElementById('xp-text').textContent = `${userData.xp} / ${xpForNext} XP`;
            
            loadAchievements();
            loadScores();
        }
        
        function loadAchievements() {
            const container = document.getElementById('achievements-container');
            container.innerHTML = '';
            allAchievements.forEach(ach => {
                const userAch = userData.achievements.find(a => a.id === ach.id);
                const unlocked = userAch && userAch.unlocked;
                const card = document.createElement('div');
                card.className = 'achievement-card' + (unlocked ? '' : ' locked');
                card.innerHTML = `
                    ${!unlocked ? '<div class="lock-icon">🔒</div>' : ''}
                    <div class="achievement-icon">${ach.icon}</div>
                    <div class="achievement-name">${ach.name}</div>
                    <div class="achievement-desc">${ach.description}</div>
                    <div class="achievement-xp">+${ach.xp} XP</div>
                `;
                container.appendChild(card);
            });
        }
        
        function loadScores() {
            const tbody = document.getElementById('scores-tbody');
            tbody.innerHTML = '';
            if (Object.keys(userData.highScores).length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4" class="no-scores">
                            <div>🎮 No high scores yet!</div>
                            <div style="font-size: 0.9em; margin-top: 10px;">Play some games!</div>
                        </td>
                    </tr>
                `;
            } else {
                Object.entries(userData.highScores).forEach(([gameId, data]) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>🎮 ${gameId}</td>
                        <td><span class="score-value">${data.score.toLocaleString()}</span></td>
                        <td>#${data.rank || 'N/A'}</td>
                        <td>${new Date(data.date).toLocaleDateString()}</td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }
        
        function openAvatarModal() {
            const modal = document.getElementById('avatar-modal');
            const container = document.getElementById('avatar-options');
            container.innerHTML = '';
            avatarOptions.forEach(url => {
                const option = document.createElement('div');
                option.className = 'option-item';
                if (userData.avatar === url) option.classList.add('selected');
                option.innerHTML = `<img src="${url}" alt="Avatar">`;
                option.onclick = () => {
                    selectedAvatar = url;
                    document.querySelectorAll('#avatar-options .option-item').forEach(el => el.classList.remove('selected'));
                    option.classList.add('selected');
                };
                container.appendChild(option);
            });
            modal.classList.add('active');
        }
        
        function saveAvatar() {
            if (selectedAvatar) {
                userData.avatar = selectedAvatar;
                document.getElementById('user-avatar').src = selectedAvatar;
                localStorage.setItem('arcadeUser', JSON.stringify(userData));
                closeModal('avatar-modal');
                alert('✅ Avatar updated!');
            }
        }
        
        function openBannerModal() {
            const modal = document.getElementById('banner-modal');
            const container = document.getElementById('banner-options');
            container.innerHTML = '';
            bannerOptions.forEach(url => {
                const option = document.createElement('div');
                option.className = 'option-item';
                if (userData.banner === url) option.classList.add('selected');
                option.innerHTML = `<img src="${url}" alt="Banner">`;
                option.onclick = () => {
                    selectedBanner = url;
                    document.querySelectorAll('#banner-options .option-item').forEach(el => el.classList.remove('selected'));
                    option.classList.add('selected');
                };
                container.appendChild(option);
            });
            modal.classList.add('active');
        }
        
        function saveBanner() {
            if (selectedBanner) {
                userData.banner = selectedBanner;
                document.getElementById('profile-banner').src = selectedBanner;
                localStorage.setItem('arcadeUser', JSON.stringify(userData));
                closeModal('banner-modal');
                alert('✅ Banner updated!');
            }
        }
        
        function openBioModal() {
            document.getElementById('bio-modal').classList.add('active');
            document.getElementById('bio-input').value = userData.bio;
            updateCharCount();
        }
        
        function saveBio() {
            const bioText = document.getElementById('bio-input').value.trim();
            userData.bio = bioText || 'No bio yet!';
            document.getElementById('bio-text').textContent = userData.bio;
            localStorage.setItem('arcadeUser', JSON.stringify(userData));
            closeModal('bio-modal');
        }
        
        function updateCharCount() {
            const input = document.getElementById('bio-input');
            const count = document.getElementById('char-count');
            if (input && count) {
                count.textContent = input.value.length;
            }
        }
        
        function toggleFriend() {
            if (!userData.friends) userData.friends = [];
            const btn = document.getElementById('friend-btn');
            const text = document.getElementById('friend-text');
            
            if (btn.classList.contains('friended')) {
                btn.classList.remove('friended');
                text.textContent = 'ADD FRIEND';
                userData.friends = userData.friends.filter(f => f !== 'viewingUser');
            } else {
                btn.classList.add('friended');
                text.textContent = '✓ FRIENDS';
                userData.friends.push('viewingUser');
            }
            
            document.getElementById('stat-friends').textContent = userData.friends.length;
            localStorage.setItem('arcadeUser', JSON.stringify(userData));
        }
        
        document.getElementById('bio-input')?.addEventListener('input', updateCharCount);
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            selectedAvatar = null;
            selectedBanner = null;
        }
        
        function logout() {
            if (confirm('Logout?')) {
                localStorage.removeItem('isLoggedIn');
                window.location.href = 'login.html';
            }
        }
        
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        }
        
        loadProfile();
    </script>
</body>
</html>
